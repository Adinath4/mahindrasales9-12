sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/m/MessageBox"],function(e,t){"use strict";var g,n,s,o,i,a,r,m,c,A,l,r,d,u,b=0,f=0,h="";var V,w,v,E;var p,_;return e.extend("sales.ext.controller.PurchaseEnquiryObjPage",{override:{onInit:function(){var e=this.base.getExtensionAPI().getModel()},editFlow:{onAfterEdit:async function(e){debugger;setTimeout(()=>{d.setEnabled(true);c.setVisible(false)},800)},onAfterSave:async function(e){debugger;c.setVisible(true);setTimeout(()=>{d.setEnabled(false);c.setVisible(true)},800);b=0}},onAfterRendering:async function(e){debugger;this.base.getView().mAggregations.content[0].mAggregations.headerTitle.mAggregations._actionsToolbar.mAggregations.content[2].mProperties.text="Review Quotation"},routing:{onAfterBinding:async function(){debugger;var e=this.base.getView().mAggregations.content[0].mAggregations.headerTitle.mAggregations._actionsToolbar.mAggregations.content[2].mProperties.text="Review Quotation";_=this.getView().mAggregations.content[0].mAggregations.sections[3].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mAggregations.columns[10].mAggregations.template.mAggregations.items[0].getSelected();debugger;const t=this.base.getView();const g=t.getContent()[0];const a=g.getSections();n=this.base.getView().mAggregations.content[0].mAggregations.sections[2].mForwardedAggregations.subSections[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mForwardedAggregations.actions[1].setVisible(false);s=this.base.getView().mAggregations.content[0].mAggregations.sections[2].mForwardedAggregations.subSections[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mForwardedAggregations.actions[2].setVisible(false);o=this.base.getView().mAggregations.content[0].mAggregations.sections[3].mForwardedAggregations.subSections[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mForwardedAggregations.actions[1].setVisible(false);i=this.base.getView().mAggregations.content[0].mAggregations.sections[3].mForwardedAggregations.subSections[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mForwardedAggregations.actions[2].setVisible(false)},onBeforeBinding:async function(e){debugger;const g=this.base.getView();const n=g.getContent()[0];const s=n.getSections();var o=this.base.getView().mAggregations.content[0].mAggregations.headerTitle.mAggregations._actionsToolbar.mAggregations.content[2].mProperties.text="Review Quotation";var i=window.location.href;const m=/purchaseEnquiryUuid=([a-fA-F0-9-]+)/;const b=/IsActiveEntity=(true|false)/;const h=i.match(b);if(h){p=h[1];console.log(p)}if(p==="false"){debugger;var w=s[2].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[2].mAggregations.content.mAggregations.content.mAggregations.formContainers[0].mAggregations.formElements;w.forEach(e=>{debugger;e.mAggregations.fields[0].mAggregations.content.setEditMode("Display")});var E=s[3].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[2].mAggregations.content.mAggregations.content.mAggregations.formContainers[0].mAggregations.formElements;E.forEach(e=>{debugger;e.mAggregations.fields[0].mAggregations.content.setEditMode("Display")});let e=s[0].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.content.mAggregations.formContainers[0].mAggregations.formElements;e.forEach(e=>{debugger;e.mAggregations.fields[0].mAggregations.content.setEditMode("Display")});s[1].findAggregatedObjects(true,function(e){return e.isA("sap.m.Input")}).forEach(function(e){debugger;e.oParent.oParent.oParent.mAggregations.fields[0].mAggregations.content.setEditMode("Display")});const t=s[2].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mAggregations._content.mAggregations.rows;t.forEach(e=>{debugger;const t=e.getCells?e.getCells():e.getAggregation("content");t.forEach((e,t)=>{debugger;e.mAggregations.content.setEditMode("Display")})});const g=s[3].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mAggregations._content.mAggregations.rows;g.forEach(e=>{debugger;const t=e.getCells?e.getCells():e.getAggregation("content");t.forEach((e,t)=>{debugger;if(t===10||t===9){}else{debugger;e.mAggregations.content.setEditMode("Display")}})})}setTimeout(async()=>{let t=e.oBinding.oElementContext;let g=t.getObject();let n="SalesOrvalue";let s=this.getView().getModel().bindContext(`/${n}(...)`);console.log();s.setParameter("SalesOrg",g.salesOrg);s.setParameter("DistChan",g.distributionChannels);s.setParameter("Division",g.division);s.setParameter("Doctype",g.docType);await s.execute();const o=s.getBoundContext();let i=o.getValue();console.log("Harsha78",i);let a=this.base.getView().mAggregations.content[0].mAggregations.sections[1].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mAggregations.formContainers[0].mAggregations.formElements[2].mAggregations.fields[0].mAggregations.content.mAggregations.contentDisplay.setTooltip(i.value[1]);let r=this.base.getView().mAggregations.content[0].mAggregations.sections[1].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mAggregations.formContainers[0].mAggregations.formElements[3].mAggregations.fields[0].mAggregations.content.mAggregations.contentDisplay.setTooltip(i.value[0]);let m=this.base.getView().mAggregations.content[0].mAggregations.sections[1].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mAggregations.formContainers[0].mAggregations.formElements[5].mAggregations.fields[0].mAggregations.content.mAggregations.contentDisplay.setTooltip(i.value[2]);let c=this.base.getView().mAggregations.content[0].mAggregations.sections[1].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mAggregations.formContainers[0].mAggregations.formElements[6].mAggregations.fields[0].mAggregations.content.mAggregations.contentDisplay.setTooltip(i.value[3])},1e3);this.base.getView().mAggregations.content[0].mAggregations.footer.mAggregations.content.mAggregations.content[4].getVisible();a=this.base.getView().mAggregations.content[0].mAggregations.sections[4];r=this.base.getView().mAggregations.content[0].mAggregations.sections[5];l=this.base.getView().mAggregations.content[0].mAggregations.sections[2];A=this.base.getView().mAggregations.content[0].mAggregations.sections[3];d=this.base.getView().mAggregations.content[0].mAggregations.sections[5].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.items[1];c=this.base.getView().mAggregations.content[0].mAggregations.footer.mAggregations.content.mAggregations.content[5];V=sap.ui.getCore().byId("sales::PurchaseEnquiryObjectPage--fe::StandardAction::SwitchDraftAndActiveObject").getVisible();let _="statusFun";debugger;let C=e.getModel().bindContext(`/${_}(...)`);const y=i.match(m);if(y){u=y[1];console.log(u)}C.setParameter("purchaseEnquiryUuid",u);await C.execute();const x=C.getBoundContext();v=x.getValue();var T=v;debugger;var P=v.value.purchaseEnquiryId;if(v.value.status==="Request"||v.value.status===null){debugger;var S=this.base.getView().mAggregations.content[0].mAggregations.footer;S.setVisible(true);var D=this.base.getView().getContent()[0].mAggregations.headerTitle.mAggregations._actionsToolbar.mAggregations.content[2].setEnabled(true);A.setVisible(false);l.setVisible(true);d.setEnabled(false);let g="requestFun";let n=e.getModel().bindContext(`/${g}(...)`);n.setParameter("peUuid",u);await n.execute();const s=n.getBoundContext();v=s.getValue();debugger;if(h[1]=="true"){if(v.value.success){t.success(v.value.message,{title:"Success",onClose:function(){console.log("Success dialog closed")}})}else{const e=v.value.message.split("<br>");const g=e.join("\n");t.warning(g,{title:"Stocks Warning",onClose:function(){console.log("Warning dialog closed")}});f=f+1}}}else if(v.value.status==="Negotiation"){var S=this.base.getView().mAggregations.content[0].mAggregations.footer;S.setVisible(true);var D=this.base.getView().getContent()[0].mAggregations.headerTitle.mAggregations._actionsToolbar.mAggregations.content[2].setEnabled(true);A.setVisible(true);l.setVisible(false);d.setEnabled(false);c.setVisible(true);const t=await new Promise((e,t)=>{jQuery.ajax({url:`https://3c552736trial-dev-mahindra-sales-srv.cfapps.us10-001.hana.ondemand.com/odata/v4/my/EnquiryVehicle?$filter=purchaseEnquiryUuid eq ${u}`,method:"GET",dataType:"json",success:function(t){e(t)},error:function(e,g,n){t(new Error(g+": "+n))}})});if(t&&t.value){for(const e of t.value){let t=e.discount||""}}let g="negotiationFun";let n=e.getModel().bindContext(`/${g}(...)`);n.setParameter("peUuid",u);await n.execute();const s=n.getBoundContext();v=s.getValue()}else if(v.value.status==="Approved"){var D=this.base.getView().getContent()[0].mAggregations.headerTitle.mAggregations._actionsToolbar.mAggregations.content[2].setEnabled(true);A.setVisible(true);l.setVisible(false);c.setVisible(false)}else if(v.value.status==="In Process"){var S=this.base.getView().mAggregations.content[0].mAggregations.footer;var D=this.base.getView().getContent()[0].mAggregations.headerTitle.mAggregations._actionsToolbar.mAggregations.content[2].setEnabled(false);d.setEnabled(false);let t="inProcessFun";let g=e.getModel().bindContext(`/${t}(...)`);g.setParameter("peUuid",u);await g.execute();const n=g.getBoundContext();v=n.getValue();l.setVisible(false);A.setVisible(true);S.setVisible(false)}if(p==="false"||T.value.status==="In Process"){c.setVisible(false)}else if(p==="true"){c.setVisible(true)}}}}})});
//# sourceMappingURL=PurchaseEnquiryObjPage.controller.js.map