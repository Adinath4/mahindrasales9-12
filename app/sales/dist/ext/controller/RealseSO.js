sap.ui.define(["sap/m/MessageToast"],function(e){"use strict";return{REalseSO:async function(t){debugger;const n=this._view.findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")&&(e.getId().includes("release-so")||e.getId().includes("Edit"))});const s=this._view;const o=s.getContent()[0];const i=o.getAggregation("footer");let a=t.oBinding.oElementContext;let r=a.getObject();const c=t.oModel.sServiceUrl;const l=c+t.sPath.slice(1)+"/purchaseToComments";const u={commentsText:r.comment,IsActiveEntity:true};const f=c+t.sPath.slice(1)+"/purchaseToVehicle";const d=await T(f);let g=true;let m=true;let p=[];var h="",y="";var w=true;if(!r.bankName)g=false;if(!r.accNumber)g=false;if(!r.ifscCode)g=false;if(!r.branch)g=false;if(!r.accHoldersName)g=false;if(!r.dueDate)g=false;if(!r.dealerCode)g=false;if(!r.comment){w=false;p.push("Comment is missing")}if(!g)p.push("Some payment details are missing.");d.value.forEach(e=>{if(!e.deliveryLeadTime||!e.deliveryDate||!e.shippingMethod||!e.shippingCharges){m=false}});if(!m)p.push("Some vehicles are missing delivery details.");const b=p.join("\n");if(!m||!g||!w){var v=new Dialog({title:"Error",type:"Message",content:new Text({text:`${b}\nPlease complete all required fields.`}),beginButton:new Button({text:"OK",press:function(){v.close()}})});v.open();return}var x=new Dialog({title:"Confirmation",type:"Message",content:new Text({text:"Do you want to send sales order for release?\nBefore sending please check all the details once again."}),beginButton:new Button({text:"Confirm",press:async function(){C();x.close()}}),endButton:new Button({text:"Cancel",press:function(){x.close()}})});async function C(){debugger;const t=JSON.stringify(r);const s=c+`sendForRelease(data='${encodeURIComponent(t)}')`;const o=await T(s);console.log(o);if(o.value){e.show("Sent for release!");if(r.comment){const e=await j(l,u)}n[0].setVisible(false);n[1].setVisible(false);i.setVisible(false)}}async function T(e){debugger;return new Promise((t,n)=>{jQuery.ajax({url:e,method:"GET",dataType:"json",success:function(e){t(e)},error:function(e,t,s){n(new Error(t+": "+s))}})})}async function j(e,t){debugger;return new Promise((n,s)=>{jQuery.ajax({url:e,method:"POST",contentType:"application/json",data:JSON.stringify(t),success:function(e){debugger;n(e)},error:function(e,t,n){s(new Error(`${t}: ${n}`))}})})}x.open()}}});
//# sourceMappingURL=RealseSO.js.map